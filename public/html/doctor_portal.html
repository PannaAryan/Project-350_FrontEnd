<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Doctor Dashboard</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/utilities.css">
    <link rel="stylesheet" href="../css/dashboard_style.css">
</head>

<body>

    <div style="margin-top: 200px; text-align: center;"> 
        <h1>Dr. Ahmed Rahman</h1> 
        <h2>Dental Medicine</h2> 
        <!-- <h3>Specialized Skills:</h3> -->
        <ul> 
            <li><h2>Available Slots</h2></li> 
            <!-- <li>Time:</li> -->
            </ul>
        <div style="margin-top: 20px; text-align: center; width: 300px; margin:auto;">
            <input type="time" id="timeInput" placeholder="HH:MM AM/PM">
            <button onclick="addTime()">Add Time</button>
        </div>
    </div>
    
    
        <div style="margin-top: 200px; text-align: center;">
            <ol style="--length: 4" role="list">
                <!-- Today's Appointments -->
        
                <li style="--i: 1">
                    <!-- <h1>Dr. Ahmed Rahman</h1>
                    <h2>Dental Medicine</h2> -->
                    <h3 class="text-white">Today's Appointments</h3>
                    <ul id="todays-appointments">
                        <li class="text-white ">Appointment with John Doe at 10:00 AM</li>
                        <li class="text-white">Appointment with Jane Doe at 11:00 AM</li>
                        <!-- More appointments can be added here -->
                    </ul>
                </li>
        
                <section id="logout">
                    <button id="logout-button">Logout</button>
                </section>
        
        
        
                <!-- Other Sections... -->
                <!-- Add other sections as per your requirements -->
            </ol>
        </div>

    <script>

        document.addEventListener('DOMContentLoaded', function () {
            const logoutButton = document.getElementById('logout-button');
            logoutButton.addEventListener('click', function () {
                window.location.href = 'http://127.0.0.1:5500/public/html/home.html';
            });
        });
        document.addEventListener('DOMContentLoaded', function () {
            fetchAppointments('todays-appointments', '/api/appointments/today');
            fetchAppointments('pending-appointments', '/api/appointments/pending');
            fetchEmergencyAvailability();
        });

        async function fetchAppointments(elementId, apiEndpoint) {
            try {
                const response = await fetch(apiEndpoint);
                const appointments = await response.json();

                const ul = document.getElementById(elementId);
                appointments.forEach(appointment => {
                    const li = document.createElement('li');
                    li.textContent = `Appointment with ${appointment.patientName} at ${appointment.time}`;
                    ul.appendChild(li);
                });
            } catch (error) {
                console.error('Error fetching appointments:', error);
            }
        }

        async function fetchEmergencyAvailability() {
            try {
                const response = await fetch('/api/doctor/emergency-availability');
                const { isAvailable } = await response.json();

                const p = document.getElementById('emergency-availability');
                p.textContent = isAvailable ? 'Available for emergencies' : 'Not available for emergencies';
            } catch (error) {
                console.error('Error fetching emergency availability:', error);
            }
        }
    </script>
</body>

</html>